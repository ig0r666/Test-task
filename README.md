# Описание проекта
- Проект представляет из себя реализацию тестового задания для Cloud.ru Camp.
- В каталоге balancer - реализация Балансировщика нагрузки.
- В каталоге limiter - реализация Rate Limiter'a.
- Каталог serverpool выделяет пул серверов, необходимый для распределения нагрузки в балансировщике.

## Разработка HTTP-балансировщика нагрузки на Go
- Для переадресации и для работы с запросами использовалась стандартная библиотека net/http (net/http/httputil).
- Логгирование с помощью slog.
- Для работы с yaml конфигом использовался cleanenv.
- Docker для контейнеризации.
- Предусмотрено использование других алгоритмов балансировки (например, least connections) путем использования интерфейсов.
- Обеспечена необходимая потокобезопасность.
- HealthChecking с заданным интервалом (задается в конфиге *healthcheck_interval* или через переменные окружения *HEALTHCHECK_INTERVAL* в compose.yaml).
- При обнаружении неработающего сервера, балансировщик исключает его из пула серверов до следующего вызова healtcheck.
- Пул серверов регулируется с помощью параметра *URLS*
  
## Реализация Rate-Limiting
- PostgreSQL для хранения состояний клиентов.
- slog для логгирования.
- cleanenv для работы с yaml конфигом.
- net/http для работы с HTTP.
- golang-migrate для миграций.
- Docker для контейнеризации.
- Также был реализован простой CRUD для гибкой работы с каждым из клиентов в отдельности.
- Обеспечена персистентность, путем сохранения в БД состояний клиентов.
- Обеспечена необходимая потокобезопасность.
- Использование интерфейсов для Limiter'a и БД.
- Дефолтный лимит выставляется в конфиге *capacity* или через переменные окружения *CAPACITY* в compose.yaml.
- Частота обновления токенов регулируется через *UPDATE_INTERVAL*.
- CRUD подробно прокомментирован в limiter/adapters/rest/handlers.go
  
## Запуск проетка
**Запустить балансировщик можно двумя способами:**
  + Из директории balancer через командную строку: *go run main.go -config config.yaml*. При таком способе запуска придется запустить serverpool отдельно, для этого в директории serverpool выполните команду *go run main.go -config config.yaml*
  + Из корня проекта с помощью команды *make balancer-up*.
    
**Аналогично для лимитера, его можно запустить двумя способами:**
  + Из директории limiter через командную строку: *go run main.go -config config.yaml*. При таком способе запуска придется поднимать postgres отдельно, рекомендуется использовать второй вариант.
  + Из корня проекта с помощью команды *make limiter-up*.
- Чтобы запустить сразу балансировщик и лимитер, выполните команду *make up* в корне проекта.
- Для остановки проекта выполните команду *make down* в корне проекта.
- Для полной очистки и остановки выполните *make clean* в корне проекта.
- В текущей конфигурации, балансировщик будет запущен на 8080 порту, а Limiter на 8081 порту
